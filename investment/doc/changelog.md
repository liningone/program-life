# 投资-定投
开发过程记录

## 2024-05-09 背景
本人入A股一年了，对于我来说：在股市，付出并不等于回报。
我投入了资金，也投入了时间用于学习研究国家经济、行业情况，也投入了时间锻炼自己的理财心态，
当然也有一些不应该的投入：对股票的短期波动投入了太多关注和情绪。
我最近这一年买入了5个行业的指数，除了一个指数小赚外，其余指数都大亏，
小赚的指数也是运气成分居多...说白了我无法把资金+时间投入转换为正收益

我是个懒人，我也不想投入更多的时间成本了(投入越多可能亏越多，股市新人太依赖大盘行情和运气了)，
既然无法预测、判断行情，我决定用定投来解放自己，回归股票交易的本质:低买高卖。某个指数低估了就定投买入，涨到中高位就卖出。

然而制定定投策略并不简单，需要考虑定投入场时间，定投期数，定投间隔，单次定投金额，止盈线，还有风险控制（主要是止损线）
我之前的股市交易，操作前也做了一些调研分析，但是更多的是拍脑袋在做决定，这次制定定投策略我想基于数据去决定。
所以我想开发一个工具用于验证我设想的定投策略的潜在收益情况

## 2024-05-09 需求列表
1.用股市历史数据验证定投策略的收益情况     
2.支持指定目标股票/指数，时间长度，定投周期，定投间隔，定投金额，止盈线，止损线，定投条件   
3.给出收益率情况，包括期间最大的亏损收益，最大的收益率，收益率曲线，亏损的天数     
4.(未来需求) 定投策略横向评分（可以基于风险偏好）      
5.(未来需求) 根据股票历史数据挖掘出最佳的定投策略    

## 2024-05-13 内部实现
主要有3个部分：
    股票数据服务：提供股票k线图数据
    投资计算器：计算投资收益
    定投计算器：提供定投模拟，计算定投收益

股票数据服务
    对外接口
        查询目标股票指定时间时间范围的k线图数据
    内部实现
        数据来源有3个：网络数据，本地数据，数据库（v1不支持）
        网络数据的来源：Alpha Vantage，sina
        本地数据的来源：本地json文件
        网络接口查询结果可以导入到本地数据和数据库

## 2024-05-21 版本介绍
收益计算器v1
    收益信息: 持有收益, 持有收益率, 持有份额
    使用场景：计算当前时间的收益，计算每个操作时间的收益情况，计算每天的收益情况
定投计算器v1
    定投参数：目标股票，目标股票, 定投起始时间, 定投结束时间, 单次定投金额 ，定投周期
    收益信息：持有收益, 持有收益率, 持有份额
    定投结果：当前时间的收益情况，每次定投时间的收益情况

## 2024-05-22 定投需求分析
定投能不能赚到钱？
    先做一些数据验证
        上证指数定投12期，每期买1000元，每个月1号买入，总本金12000，一年后赎回 (时间范围[2010-01-01, 2023-12-31])
            percentile0: -2822
            percentile25: -727
            percentile50: -5
            percentile75: 620
            percentile100: 9147
        上证指数每月1号买入12000元，一年后赎回 (时间范围[2010-01-01, 2023-12-31])
            percentile0: -4751
            percentile25: -1344
            percentile50: -191
            percentile75: 1072
            percentile100: 15150
        上证指数定投24期，每期买500元，每个月1号买入，总本金12000，2年后赎回 (时间范围[2010-01-01, 2023-12-31])
            percentile0: -2408
            percentile25: -759
            percentile50: -111
            percentile75: 972
            percentile100: 11511
        上证指数每月1号买入12000元，2年后赎回 (时间范围[2010-01-01, 2023-12-31])
            percentile0: -4253
            percentile25: -1620
            percentile50: -483
            percentile75: 2251
            percentile100: 13724
        初步结论：相比一次性买入，定投不能提高赚钱的概率，定投的优点是可以缩小正负收益的范围，降低亏损的同时也降低盈利
    论文资料
        "Dollar-cost averaging just means taking risk later" (PDF). twentyoverten.com. July 2012. Retrieved August 16, 2023.


市面上的定投功能支持的参数
    以支付宝的定投为例子，定投参数：单次定投金额，定投周期，智能定投[开启/关闭]
        智能定投：仅在目标指数估值低估时买入。使用指数的PE值来衡量指数估值高低情况
        估值区间划分定义
            高估：高于指数历史整体估值70%分位 [100%, 70%]
            正常：位于指数历史整体估值30%-70%分位 (30%, 70%)
            低估：低于指数历史整体估值30%分位 [0%, 30%]
    股票交易的本质是低买高卖，买入时考虑估值因素挺合理的。我们假设一些可能的情况来对比下普通定投和智能定投的收益
    假设定投期间市场是一路牛市，开启智能定投，投入的本金也较少，收益也比较少
    假设定投期间市场是一路熊市，是否开启智能定投的收益区别不大，投入的本金也区别不大，亏的钱也差不多
    假设定投期间市场是先牛市后熊市，开启智能定投，在牛市时投入的本金比较少，赚的也比较少。
        到了熊市，因为最初牛市时本金投入较低，最后亏的也比较少
    假设定投期间市场是先熊市后牛市，在熊市时两种方式投入的本金本金，亏的钱都差不多。
        到牛市时智能定投投入的本金较少，收益较少

    感觉智能定投（相对于普通定投）的本质是：在市场低迷时买入的股票比市场高涨时买入的股票更多，进一步降低买入成本
    简单来说，智能定投牺牲了部分正收益去降低负收益。也就是控制风险，普通定投是高回报高风险，智能定投是低回报低风险

支持更多的定投参数是不是伪需求？
    有没有一种可能目前的定投参数已经是最合适的定投方案了，新增参数反而是画蛇添足。
    接下来先分析已有的定投参数对定投收益的影响，在考虑增加更多的定投参数
    
定投和量化交易的区别？
    待分析    

## 2024-05-23 头脑风暴
支持更多定投参数
更多角度的定投收益分析
预测未来的收益？ （有种量化交易的感觉）
定投方案打分  (收益波动率，收益率)
定投结果报告
多个定投方案的结果对比 (相同指数/不同指数)
定投策略生成器
    目标指数+个人倾向 ----> 定投策略

一次定投的生命周期
    创建
    停止
    修改
    赎回（终止)

## 2024-05-27 定投分析
以定投上证指数为例，怎么定投才提高赚钱的概率，降低亏损率？

定投期数对收益的影响
    用折线图
    上证指数定投12期，每期买1000元，每个月1号买入，总本金12000，一年后赎回 (时间范围[2010-01-01, 2023-12-31])
        percentile0: -2822
        percentile25: -727
        percentile50: -5
        percentile75: 620
        percentile100: 9147
    上证指数定投24期，每期买500元，每个月1号买入，总本金12000，2年后赎回 (时间范围[2010-01-01, 2023-12-31])
        percentile0: -2408
        percentile25: -759
        percentile50: -111
        percentile75: 972
        percentile100: 11511    
    